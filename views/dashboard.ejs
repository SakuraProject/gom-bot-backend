<html>
<body>
<% if(redir){ %>
    <script>
        window.location.href = "<%= redir %>";
    </script>
    <style>
html, body {
  height: 100%;
}
html {
  background: #eee;
}
body {
  display: flex;
  justify-content: center;
  align-items: center;
}
.box {
  width: 300px;
  height: 300px;
  border-radius: 5px;
  box-shadow: 0 2px 30px rgba(black, .2);
  background: lighten(#f0f4c3, 10%);
  position: relative;
  overflow: hidden;
  transform: translate3d(0, 0, 0);
}
.wave {
  opacity: .4;
  position: absolute;
  top: 3%;
  left: 50%;
  background: #0af;
  width: 500px;
  height: 500px;
  margin-left: -250px;
  margin-top: -250px;
  transform-origin: 50% 48%;
  border-radius: 43%;
  animation: drift 3000ms infinite linear;
}
.wave.-three {
  animation: drift 5000ms infinite linear;
}
.wave.-two {
  animation: drift 7000ms infinite linear;
  opacity: .1;
  background: yellow;
}
.box:after {
  content: '';
  display: block;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  background: linear-gradient(to bottom, rgba(#e8a, 1), rgba(#def, 0) 80%, rgba(white, .5));
  z-index: 11;
  transform: translate3d(0, 0, 0);
}
.title {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  z-index: 1;
  line-height: 300px;
  text-align: center;
  transform: translate3d(0, 0, 0);
  color: white;
  text-transform: uppercase;
  font-family: 'Playfair Display', serif;
  letter-spacing: .4em;
  font-size: 24px;
  text-shadow: 0 1px 0 rgba(black, .1);
  text-indent: .3em;
}
@keyframes drift {
  from { transform: rotate(0deg); }
  from { transform: rotate(360deg); }
}
    </style>
    <div class='box'>
        <div class='wave -one'></div>
        <div class='wave -two'></div>
        <div class='wave -three'></div>
        <div class='title'>Now Loading</div>
    </div>
<% }else{ %>
<style>
    @import url(https://fonts.googleapis.com/css?family=Bitter);
    body {
      margin: 0;
      font-family: 'Bitter', serif;
      text-align: center;
    }
    .holder,
    .first,
    .second,
    .third {
      height: 100%;
      width: 100vw;
    }
    .first,
    .second,
    .third {
      position: absolute;
    }
    .second,
    .third {
      opacity: 0;
    }
    .holder {
      height: 100%;
      position: relative;
      z-index: 1;
    }
    .first {
      animation: first 10s infinite;
      background: linear-gradient(#5ff8ca, #60e08c);
      z-index: 10;
    }
      @keyframes first {
        0% {opacity: 1.0;}
        10% {opacity: 0.8;}
        20% {opacity: 0.6;}
        30% {opacity: 0.4;}
        40% {opacity: 0.2;}
        50% {opacity: 0.1;}
        60% {opacity: 0.2;}
        70% {opacity: 0.4;}
        80% {opacity: 0.6;}
        90% {opacity: 0.8;}
        100% {opacity: 1.0;}
      }
    .second {
      animation: second 10s infinite; animation-delay: 2s;
      background: linear-gradient(#19eaa6, #00a1f0);
      z-index: 20;
    }
      @keyframes second {
        0% {opacity: 0;}
        10% {opacity: 0.2;}
        20% {opacity: 0.4;}
        30% {opacity: 0.6;}
        40% {opacity: 0.8;}
        50% {opacity: 1.0;}
        60% {opacity: 0.8;}
        70% {opacity: 0.6;}
        80% {opacity: 0.4;}
        90% {opacity: 0.2;}
        100% {opacity: 0;}
      }
    .third {
      animation: third 10s infinite;
      animation-delay: 8s;
      background: linear-gradient(#aab7f8, #ff75c6);
      z-index: 30;
    }
      @keyframes third {
        0% {opacity: 0;}
        10% {opacity: 0.2;}
        20% {opacity: 0.4;}
        30% {opacity: 0.6;}
        40% {opacity: 0.8;}
        50% {opacity: 1.0;}
        60% {opacity: 0.8;}
        70% {opacity: 0.6;}
        80% {opacity: 0.4;}
        90% {opacity: 0.2;}
        100% {opacity: 0;}
      }
    .txt {
      position: absolute;
      width: 100%;
      height: fit-content;
      z-index: 1000;
    }
    h1 {
      font-size: 40px;
      font-weight: 400;
      margin: 0;
    }
    p {
      font-size: 20px;
      margin-top: 26px;
    }
</style>
  <div class="holder" id="holder">
    <div class="first"></div>
    <div class="second"></div>
    <div class="third"></div>
    <div class="txt" id="txt">
    <% if(!g){ %>
    <style>
        .icon {
            height:64px;
            width:64px;
            margin:10px;
            border-radius:32px;
        }
        
.wrapper {
  display: grid;
  grid-template-columns: 64px 64px 64px 64px;
}
.grid {
  height: 64px;
}
    </style>
    <div class="wrapper">
    <% for(i=0;i<guilds.length;i++){ %>
      <div class="grid"><a href="/dashboard?g=<%= guilds[i]["id"] %>"><% if(guilds[i]["icon"]["url"]){ %><img class="icon" src="<%= guilds[i]["icon"]["url"] %>" align="middle"><% }else{ %><div class="icon" style="overfllow:hidden;"><%= guilds[i]["name"] %></div><% } %></a></div>
    <% } %>
</div>
    <% }else{ %>
        <% if(!ch){ %>
        <style>
        .listbox {
            background:#ffbdde;
            margin:30px;
            border:solid 1px #46AF16;
            height:60px;
            border-radius:25px;
        }
        </style>
        <% for(i=0;i<guilds.length;i++){ %>
        <% if(g==guilds[i]["id"]){ %>
        <% for(ci=0;ci<guilds[i]["text_channels"].length;ci++){ %>
        <a href="/dashboard?g=<%= guilds[i]["id"] %>&ch=<%= guilds[i]["text_channels"][ci]["id"] %>">
        <div class="listbox">
        <%= guilds[i]["text_channels"][ci]["name"] %>
        </div>
        </a>
        <% } %>
        <% } %>
        <% } %>
        <% }else{ %>
        <style>
            .listbox {
                background:#ffbdde;
                margin:30px;
                border:solid 1px #46AF16;
                height:50px;
                border-radius:25px;
            }
            .modal {
              position: fixed;
              left: 0;
              top: 0;
              width: 100%;
              height: 100%;
              z-index: 9999;
              opacity: 0;
              visibility: hidden;
              -webkit-transition: .6s;
              transition: .6s;
            }

            .modal.is-show {
              opacity: 1;
              visibility: visible;
            }

            .modal_inner {
              position: absolute;
              left: 50%;
              top: 50%;
              -webkit-transform: translate(-50%, -50%);
                      transform: translate(-50%, -50%);
              width: 80%;
              max-width: 600px;
              padding: 50px;
              background-color: #fff;
              z-index: 2;
            }

            .modal_inner img {
              width: 100%;
            }

            .modal_close {
              position: absolute;
              right: 0;
              top: 10px;
              width: 50px;
              height: 50px;
              line-height: 50px;
              text-align: center;
              cursor: pointer;
            }

            .modal_close i {
              font-size: 20px;
              color: #333;
            }

            .modal_background {
              position: absolute;
              left: 0;
              top: 0;
              width: 100%;
              height: 100%;
              background-color: rgba(0, 0, 0, 0.8);
              z-index: 1;
              cursor: pointer;
            }

            .button{
              font-size: 20px;
            }
        </style>
        <script>
            function cmdc(obj){
            modal = obj.lastElementChild;
            backGround = modal.lastElementChild;
            modal.classList.add('is-show');
            backGround.classList.add('is-show');
            }
            function cmde(obj){
            modal.className="modal";
            backGround.className="modal_background";
            }
            function ir(e) {
            ivr = document.getElementById('ivr');
            ivr.innerHTML = e;
            cmde();
            cmdc(document.getElementById('r'));
            }
            function invoke(obj){
            cm = "sk!" + obj.elements[0].value;
            for(it=1;it<obj.elements.length-1;it++){
            cm = cm+ " " + obj.elements[it].value;
            }
            ch = "<%= ch %>";
            var request = "ch=" + ch + "&cm=" + encodeURI(cm);
            fetch("/dashboard/invoke",{method:"POST",headers:{'Content-Type':'application/x-www-form-urlencoded;charset=utf-8','Accept':'application/json'},body:request}).then(response => response.text()).then(data => ir(data))
            }
        </script>
        <% for(i=0;i<cmds.length;i++){ %>
        <div class="listbox" onclick="cmdc(this);">
        <%= cmds[i]["res"]["name"] %><% if (cmds[i]["res"]["doc"]){ %>：<% if (cmds[i]["res"]["doc"]["sd"][ll]){ %><%= cmds[i]["res"]["doc"]["sd"][ll] %><% }else{ %><%= cmds[i]["res"]["doc"]["sd"]["default"] %><% } %><% } %>
        <div id="modal" class="modal">
            <div class="modal_inner">
                 <button id="modal_close" class="modal_close" onclick="setTimeout(cmde,1000);">×close</button>
                 <form>
                 <input type="hidden" value="<%= cmds[i]["res"]["name"] %>">
                 <% for(p = 0; p<cmds[i]["res"]["clean_params"].length;p++){ %>
                 <% if(lpack[ll][cmds[i]["res"]["clean_params"][p]["name"]]){ %>
                     <%= lpack[ll][cmds[i]["res"]["clean_params"][p]["name"]] %>
                 <% }else{ %>
                     <%= cmds[i]["res"]["clean_params"][p]["name"] %>
                 <% } %>
                 <input <% if(cmds[i]["res"]["clean_params"][p]["required"]){ %>required<% } %>>
                 <% } %>
                 <button onclick="invoke(this.parentElement);return false;">実行</button>
                 </form>
            </div>
            <div id="modal_background" class="modal_background" onclick="setTimeout(cmde,1000);"></div>
            </div>
        </div>
        <% } %>
            <div id="r">
            <div id="rmodal" class="modal">
            <div class="modal_inner">
                 <button id="modal_close" class="modal_close" onclick="setTimeout(cmde,1000);">×close</button>
                 <div id="ivr"></div>
            </div>
            <div id="rmodal_background" class="modal_background" onclick="setTimeout(cmde,1000);"></div>
            </div>
        <% } %>
    <% } %>
    </div>
  </div>
  <script>
      txt = document.getElementById("txt");
      hol = document.getElementById("holder");
      if(hol.clientHeight<txt.clientHeight){
      hol.style.height = txt.clientHeight;
      }
  </script>
<% } %>
</body>
</html>